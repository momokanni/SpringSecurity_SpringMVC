/*!
 * jquery.fn.scrollable
 * @author ydr.me
 * @version 1.0
 */
(function(d,f){var c="jquery-scrollable____",b=function(){},e={listSelector:"li",width:"auto",height:"auto",direction:"top",scrollCount:1,delay:2000,duration:678,isAutoPlay:true,isHoverPause:true,onbeforechange:b,onafterchange:b};d.fn.scrollable=function(h){var g=arguments;return this.each(function(){var k=d(this),j=k.data(c),i=d.extend({},e,d.type(h)==="object"&&h);if(!j){k.data(c,(j=new a(k,i)));j._init();}if(d.type(h)==="string"&&a.prototype[h]){j[h]();}else{if(d.type(h)==="number"){j.to.apply(j,g);}}});};d.fn.scrollable.defaults=e;function a(h,g){this.$element=d(h);this.options=g;}a.prototype={_init:function(){var k=this,p=k.options,o=k.$element,h=d(o).children(p.listSelector),l=h.length;if(!l||l<2){return;}var g=o.width(),n=o.height(),i=o.clone(true,true).removeAttr("id"),m=p.direction==="left"||p.direction==="right",j;if(p.width==="auto"){p.width=o.width();}if(p.height==="auto"){p.height=o.height();}if(g*l<=p.width&&m||n*l<=p.height&&!m){return;}o.wrap("<div>");j=o.parent();j.css({position:"relative",width:p.width,height:p.height});o.wrap("<div>");$animate=o.parent();$animate.css({position:"absolute",top:0,left:0});i.insertAfter(o);if(m){k.animateKey="left";$animate.css({width:"99999%",height:p.height});o.add(i).css("float","left");g=o.outerWidth();$animate.width(g*2).height(p.height);}else{k.animateKey="top";$animate.css({width:p.width,height:n*2});}k.$animate=$animate;k.$list=o.children("li");k.$elementClone=i;k.$listClone=i.children("li");k.count=k.$list.length;k.perAnimateLeft=g*30/p.duration;k.perAnimateTop=n*30/p.duration;k.isMarquee=p.scrollCount===0;k.animateLen=0;k.showIndex=0;k.isAnimating=0;k.isHorizontal=m;k.intervalId=0;k.timeoutId=0;k.contentWidth=g;k.contentHeight=n;if(p.isAutoPlay){k.play();}j.hover(function(){k.pause();},function(){k.pause();if(p.isAutoPlay){k.play();}});},_run:function(k,n){var m=this,j=m.options,h=m.$element;if(m.isAnimating){return;}var i=m.$elementClone.position()[m.animateKey],g={},l=m.$list;if((k!="prev"&&j.direction=="top")||(k=="prev"&&j.direction=="bottom")){if(m.isMarquee){if(m.animateLen-m.perAnimateTop<=-m.contentHeight){m.animateLen+=m.contentHeight;}m.animateLen-=m.perAnimateTop;}else{if(m.contentHeight+Math.floor(m.animateLen)<=0){m.animateLen=m.contentHeight+m.animateLen;m.$animate.css("margin-"+m.animateKey,m.animateLen);}m.showIndex+=j.scrollCount;if(m.showIndex>=m.count){m.showIndex=(m.showIndex+m.count)%m.count;l=m.$listClone;}m.animateLen=-l.eq(m.showIndex).position()[m.animateKey];}}else{if((k!="prev"&&j.direction=="right")||(k=="prev"&&j.direction=="left")){if(m.isMarquee){if(m.animateLen+m.perAnimateLeft>=0){m.animateLen-=m.contentWidth;}m.animateLen+=m.perAnimateLeft;}else{m.showIndex-=j.scrollCount;if(m.showIndex<0&&Math.floor(m.animateLen)+m.contentWidth>=0){m.animateLen-=m.contentWidth;m.$animate.css("margin-"+m.animateKey,m.animateLen);}m.showIndex=(m.showIndex+m.count)%m.count;m.animateLen=-l.eq(m.showIndex).position()[m.animateKey];}}else{if((k!="prev"&&j.direction=="bottom")||(k=="prev"&&j.direction=="top")){if(m.isMarquee){if(m.animateLen+m.perAnimateTop>=0){m.animateLen-=m.contentHeight;}m.animateLen+=m.perAnimateTop;}else{m.showIndex-=j.scrollCount;if(m.showIndex<0&&Math.floor(m.animateLen)+m.contentHeight>=0){m.animateLen-=m.contentHeight;m.$animate.css("margin-"+m.animateKey,m.animateLen);}m.showIndex=(m.showIndex+m.count)%m.count;m.animateLen=-l.eq(m.showIndex).position()[m.animateKey];}}else{if((k!="prev"&&j.direction=="left")||(k=="prev"&&j.direction=="right")){if(m.isMarquee){if(m.animateLen-m.perAnimateLeft<=-m.contentWidth){m.animateLen+=m.contentWidth;}m.animateLen-=m.perAnimateLeft;}else{if(m.contentWidth+Math.floor(m.animateLen)<=0){m.animateLen=m.contentWidth+m.animateLen;m.$animate.css("margin-"+m.animateKey,m.animateLen);}m.showIndex+=j.scrollCount;if(m.showIndex>=m.count){m.showIndex=(m.showIndex+m.count)%m.count;l=m.$listClone;}m.animateLen=-l.eq(m.showIndex).position()[m.animateKey];}}}}}g["margin-"+m.animateKey]=m.animateLen;if(!m.isMarquee){m.isAnimating=1;j.onbeforechange.call(h[0]);}m.isMarquee?m.$animate.css(g):m.$animate.animate(g,j.duration,function(){if(d.isFunction(n)){n();}m.isAnimating=0;j.onafterchange.call(h[0]);});},play:function(){var h=this,g=h.options;if(h.intervalId){return;}if(h.isMarquee){if(h.timeoutId){return;}h.timeoutId=setTimeout(function(){h.intervalId=setInterval(function(){h._run();},30);},g.delay);}else{h.intervalId=setInterval(function(){h._run();},g.delay);}},pause:function(){var h=this,g=h.options;if(g.isHoverPause){if(h.intervalId){clearInterval(h.intervalId);}h.intervalId=0;}if(h.isMarquee&&g.isAutoPlay){if(h.timeoutId){clearTimeout(h.timeoutId);}h.timeoutId=0;}},to:function(j,h,n){var i=this,p=i.options,o=i.$element;if(i.isAnimating){return;}var l=i.$list.eq(j).position()[i.animateKey],m=Math.abs(Math.abs(l)-Math.abs(i.animateLen)),k={},g=p.duration;if(m<=0){return;}if(d.isFunction(h)){n=h;h=0;}if(h){g=h;}i.pause();if(i.isMarquee&&!h){g=i.isHorizontal?m*30/i.perAnimateLeft:m*30/i.perAnimateTop;}i.animateLen=-l;k["margin-"+i.animateKey]=i.animateLen;i.showIndex=j;i.isAnimating=1;p.onbeforechange.call(o[0]);i.$animate.stop(1,1).animate(k,g,i.isMarquee?"linear":"swing",function(){if(p.isAutoPlay){i.play();}i.isAnimating=0;if(d.isFunction(n)){n.call(o[0]);}p.onafterchange.call(o[0]);});},prev:function(){var h=this,g=h.options;if(!h.isMarquee){h.pause();h._run("prev",function(){if(g.isAutoPlay){h.play();}});}},next:function(){var h=this,g=h.options;if(!h.isMarquee){h.pause();h._run("next",function(){if(g.isAutoPlay){h.play();}});}}};})(jQuery);